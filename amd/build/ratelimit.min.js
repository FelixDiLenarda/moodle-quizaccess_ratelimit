define ("quizaccess_ratelimit/ratelimit",["exports","jquery","core/ajax","core/modal_factory"],function(a,b,c,d){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=e(b);c=e(c);d=e(d);function e(a){return a&&a.__esModule?a:{default:a}}var f="#mod_quiz_preflight_form input#id_submitbutton",g=function(a){var d=Date.now()+1e3*a;(0,b.default)(f).click(function(g){g.preventDefault();(0,b.default)(f).prop("disabled",!0);c.default.call([{methodname:"quizaccess_ratelimit_get_waiting_time",args:{},done:function done(b){a=Math.floor((d-Date.now())/1e3);a=Math.max(0,a);if(b.seconds>=a){var c=Math.floor(Math.random()*a);h(c,b.message)}else{h(b.seconds,b.message)}},fail:function fail(){var a=Math.floor(10*Math.random());h(a)}}])})};a.init=g;var h=function(a){var c=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"";Y.use("moodle-core-formchangechecker",function(){M.core_formchangechecker.set_form_submitted()});if(0===a){(0,b.default)("#mod_quiz_preflight_form").submit();return}if(10<a){d.default.create({body:c}).then(function(a){a.show()})}var e=Date.now()+1e3*a,g=(0,b.default)(f).val(),h=function(){if((0,b.default)("#mod_quiz_preflight_form").is(":visible")){return!1}clearInterval(j);clearTimeout(k);(0,b.default)(f).prop("disabled",!1);(0,b.default)(f).val(g);return!0},i=function(){var a=Math.round((e-Date.now())/1e3),c=Math.floor(a/60).toString()+":"+(a%60).toString().padStart(2,"0");(0,b.default)(f).val(g+" ("+c+")");h()};i();var j=setInterval(i,1e3),k=setTimeout(function(){clearInterval(j);if(!h()){(0,b.default)("#mod_quiz_preflight_form").submit()}},1e3*a)}});
//# sourceMappingURL=ratelimit.min.js.map
